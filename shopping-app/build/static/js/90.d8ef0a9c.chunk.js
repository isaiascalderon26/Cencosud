(this["webpackJsonpshopping-app"]=this["webpackJsonpshopping-app"]||[]).push([[90],{977:function(e,t,n){"use strict";n.r(t),n.d(t,"GoogleAuthWeb",(function(){return u}));var a=n(1),r=n(4),i=n(6),s=n(7),c=n(8),o=n(9),u=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.call(this)}return Object(s.a)(n,[{key:"loadScript",value:function(){if("undefined"!==typeof document){var e="gapi";if(!(null===document||void 0===document?void 0:document.getElementById(e))){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.defer=!0,n.async=!0,n.id=e,n.onload=this.platformJsLoaded.bind(this),n.src="https://apis.google.com/js/platform.js",t.appendChild(n)}}}},{key:"initialize",value:function(){var e,t,n=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clientId:"",scopes:[],grantOfflineAccess:!1};if("undefined"!==typeof window){var r=null===(e=document.getElementsByName("google-signin-client_id")[0])||void 0===e?void 0:e.content,i=a.clientId||r||"";i||console.warn("GoogleAuthPlugin - clientId is empty"),this.options={clientId:i,grantOfflineAccess:null!==(t=a.grantOfflineAccess)&&void 0!==t&&t,scopes:a.scopes||[]},this.gapiLoaded=new Promise((function(e){window.gapiResolve=e,n.loadScript()})),this.addUserChangeListener()}}},{key:"platformJsLoaded",value:function(){var e=this;gapi.load("auth2",(function(){var t={client_id:e.options.clientId,plugin_name:"CodetrixStudioCapacitorGoogleAuth"};e.options.scopes.length&&(t.scope=e.options.scopes.join(" ")),gapi.auth2.init(t),window.gapiResolve()}))}},{key:"signIn",value:function(){var e=Object(r.a)(Object(a.a)().mark((function e(){var t=this;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r.a)(Object(a.a)().mark((function e(n,r){var i,s,c,o,u,p;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(c=null!==(i=t.options.grantOfflineAccess)&&void 0!==i&&i)){e.next=9;break}return e.next=5,gapi.auth2.getAuthInstance().grantOfflineAccess();case 5:o=e.sent,s=o.code,e.next=11;break;case 9:return e.next=11,gapi.auth2.getAuthInstance().signIn();case 11:if(u=gapi.auth2.getAuthInstance().currentUser.get(),!c){e.next=15;break}return e.next=15,u.reloadAuthResponse();case 15:(p=t.getUserFrom(u)).serverAuthCode=s,n(p),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),r(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(r.a)(Object(a.a)().mark((function e(){var t;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gapi.auth2.getAuthInstance().currentUser.get().reloadAuthResponse();case 2:return t=e.sent,e.abrupt("return",{accessToken:t.access_token,idToken:t.id_token,refreshToken:""});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=Object(r.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",gapi.auth2.getAuthInstance().signOut());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"addUserChangeListener",value:function(){var e=Object(r.a)(Object(a.a)().mark((function e(){var t=this;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gapiLoaded;case 2:gapi.auth2.getAuthInstance().currentUser.listen((function(e){t.notifyListeners("userChange",e.isSignedIn()?t.getUserFrom(e):null)}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserFrom",value:function(e){var t={},n=e.getBasicProfile();t.email=n.getEmail(),t.familyName=n.getFamilyName(),t.givenName=n.getGivenName(),t.id=n.getId(),t.imageUrl=n.getImageUrl(),t.name=n.getName();var a=e.getAuthResponse(!0);return t.authentication={accessToken:a.access_token,idToken:a.id_token,refreshToken:""},t}}]),n}(n(21).c)}}]);
//# sourceMappingURL=90.d8ef0a9c.chunk.js.map