{"version":3,"sources":["../../../src/web.ts"],"names":["StorageWeb","_WebPlugin","_inherits","_super","_createSuper","_this","_classCallCheck","group","_createClass","key","value","_configure","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","wrap","_context","prev","next","this","stop","_x","apply","arguments","_get","_callee2","options","_context2","impl","getItem","applyPrefix","abrupt","_x2","_set","_callee3","_context3","setItem","_x3","_remove","_callee4","_context4","removeItem","_x4","_keys","_callee5","keys","_this2","_context5","rawKeys","map","k","substring","prefix","length","_clear","_callee6","_iterator","_step","_context6","_createForOfIteratorHelper","s","n","done","err","e","f","_migrate","_callee7","_a","migrated","existing","oldprefix","_iterator2","_step2","oldkey","_yield$this$get","_context7","Object","filter","indexOf","get","sent","push","set","t0","finish","_removeOld","_callee8","_iterator3","_step3","_context8","window","localStorage","concat","_this3","WebPlugin"],"mappings":"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","file":"static/js/89.5aaf2026.chunk.js","sourcesContent":["import { WebPlugin } from '@capacitor/core';\n\nimport type {\n  StoragePlugin,\n  ConfigureOptions,\n  GetOptions,\n  GetResult,\n  SetOptions,\n  RemoveOptions,\n  KeysResult,\n  MigrateResult,\n} from './definitions';\n\nexport class StorageWeb extends WebPlugin implements StoragePlugin {\n  private group = 'CapacitorStorage';\n\n  public async configure({ group }: ConfigureOptions): Promise<void> {\n    if (typeof group === 'string') {\n      this.group = group;\n    }\n  }\n\n  public async get(options: GetOptions): Promise<GetResult> {\n    const value = this.impl.getItem(this.applyPrefix(options.key));\n\n    return { value };\n  }\n\n  public async set(options: SetOptions): Promise<void> {\n    this.impl.setItem(this.applyPrefix(options.key), options.value);\n  }\n\n  public async remove(options: RemoveOptions): Promise<void> {\n    this.impl.removeItem(this.applyPrefix(options.key));\n  }\n\n  public async keys(): Promise<KeysResult> {\n    const keys = this.rawKeys().map(k => k.substring(this.prefix.length));\n\n    return { keys };\n  }\n\n  public async clear(): Promise<void> {\n    for (const key of this.rawKeys()) {\n      this.impl.removeItem(key);\n    }\n  }\n\n  public async migrate(): Promise<MigrateResult> {\n    const migrated: string[] = [];\n    const existing: string[] = [];\n    const oldprefix = '_cap_';\n    const keys = Object.keys(this.impl).filter(k => k.indexOf(oldprefix) === 0);\n\n    for (const oldkey of keys) {\n      const key = oldkey.substring(oldprefix.length);\n      const value = this.impl.getItem(oldkey) ?? '';\n      const { value: currentValue } = await this.get({ key });\n\n      if (typeof currentValue === 'string') {\n        existing.push(key);\n      } else {\n        await this.set({ key, value });\n        migrated.push(key);\n      }\n    }\n\n    return { migrated, existing };\n  }\n\n  public async removeOld(): Promise<void> {\n    const oldprefix = '_cap_';\n    const keys = Object.keys(this.impl).filter(k => k.indexOf(oldprefix) === 0);\n    for (const oldkey of keys) {\n      this.impl.removeItem(oldkey);\n    }\n  }\n\n  private get impl(): Storage {\n    return window.localStorage;\n  }\n\n  private get prefix(): string {\n    return this.group === 'NativeStorage' ? '' : `${this.group}.`;\n  }\n\n  private rawKeys(): string[] {\n    return Object.keys(this.impl).filter(k => k.indexOf(this.prefix) === 0);\n  }\n\n  private applyPrefix(key: string) {\n    return this.prefix + key;\n  }\n}\n"],"sourceRoot":""}